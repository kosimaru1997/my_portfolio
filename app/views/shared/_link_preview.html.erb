<script>
    document.addEventListener("turbolinks:load", function () {
    const SITE_URL = document.getElementById("url_<%= post.id %>");
    console.log(SITE_URL);

  if (SITE_URL != null) {
    const data = { key: 'f53cb9eed3ed4cebbaeb983ad7e3decb', q: SITE_URL.href };
    fetch('https://api.linkpreview.net', {
      method: 'POST',
      mode: 'cors',
      body: JSON.stringify(data),
    })
    .then(res => res.json())
    .then(response => {
      console.log(response)
      document.getElementById("h_<%= post.id%>").innerHTML = response.title;
      document.getElementById("img_<%= post.id %>").src = response.image
      document.getElementById("a_<%= post.id %>").href = response.url
    })
  }
  })
  </script>